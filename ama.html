<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ask Me Anything | Fractal Accelerator</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        textarea {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            background: var(--color-white);
            border: 2px solid var(--color-charcoal);
            color: var(--color-charcoal);
            font-size: var(--text-base);
            font-family: var(--font-primary);
            resize: vertical;
        }
        textarea:focus {
            outline: none;
            box-shadow: inset 1px 1px 0 rgba(0, 0, 0, 0.1);
        }
        textarea::placeholder {
            color: var(--color-slate);
        }
        .form-group.error textarea {
            border-color: var(--color-error);
            background: #FFF5F5;
        }
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            margin-top: var(--space-3);
        }
        .radio-option {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            cursor: pointer;
        }
        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            border: 2px solid var(--color-charcoal);
            cursor: pointer;
            accent-color: var(--color-charcoal);
        }
        .radio-option span {
            font-size: var(--text-base);
        }
        .alert-error {
            padding: var(--space-4) var(--space-5);
            border: 2px solid var(--color-error);
            background: #FFF5F5;
            color: var(--color-error);
            margin-bottom: var(--space-5);
            font-size: var(--text-xs);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: none;
        }
        .success-message {
            text-align: center;
            padding: var(--space-7) 0;
        }
        .success-message h2 {
            font-size: var(--text-2xl);
            font-weight: 700;
            margin-bottom: var(--space-5);
        }
        .success-message p {
            color: var(--color-slate);
            margin-bottom: var(--space-6);
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo">FRACTAL</a>
            <nav>
                <ul class="nav-links">
                    <li><a href="apply.html">Apply Now</a></li>
                    <li><a href="hire.html">Hire Fractal Engineers</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container" style="max-width: 600px;">
            <div id="formSection">
                <div class="window">
                    <div class="window-title">ASK ME ANYTHING</div>
                    <div class="window-content">
                        <div class="form-header">
                            <h1>Ask me about SWE jobs in the Age of AI</h1>
                            <p style="text-align: left; margin-top: var(--space-4); line-height: 1.6;">In the last two years, I've placed over 50 junior engineers in full-time jobs. I write about the future of tech &amp; economy on my twitter and my substack. I love talking to new people + unblocking my peers. Ask me a question about working as an engineer in the age of AI, and I'll do my best to get back to you :)</p>
                            <p style="text-align: left; margin-top: var(--space-3); font-weight: 700;">&mdash; Andrew</p>
                        </div>

                        <div id="alertError" class="alert-error"></div>

                        <form id="amaForm">
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" id="name" name="name" required>
                                <div class="error-message">Please enter your name</div>
                            </div>

                            <div class="form-group">
                                <label for="email">Where can I send my response?</label>
                                <input type="email" id="email" name="email" required>
                                <div class="error-message">Please enter a valid email address</div>
                            </div>

                            <div class="form-group">
                                <label for="twitter">Twitter</label>
                                <input type="text" id="twitter" name="twitter" required>
                                <div class="error-message">Please enter your Twitter handle</div>
                            </div>

                            <div class="form-group">
                                <label for="phone">If it's a long answer, might call you!</label>
                                <input type="tel" id="phone" name="phone" required>
                                <div class="error-message">Please enter your phone number</div>
                            </div>

                            <div class="form-group">
                                <label for="context">Helpful context: current job title, time on the job hunt, SWE experience</label>
                                <textarea id="context" name="context" rows="4" required></textarea>
                                <div class="error-message">Please provide some context</div>
                            </div>

                            <div class="form-group">
                                <label for="question">Your question</label>
                                <textarea id="question" name="question" rows="5" required></textarea>
                                <div class="error-message">Please enter your question</div>
                            </div>

                            <div class="form-group" id="tagGroup">
                                <label>Thanks for your question! If it's relevant to a lot of my audience I might tweet it publicly. If I do, can I tag you in the response?</label>
                                <div class="radio-group">
                                    <label class="radio-option">
                                        <input type="radio" name="tagPreference" value="tag-me" required>
                                        <span>Tag me!</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="tagPreference" value="keep-anon">
                                        <span>Keep me anon</span>
                                    </label>
                                </div>
                                <div class="error-message">Please select an option</div>
                            </div>

                            <button type="submit" class="btn">Submit</button>
                        </form>
                    </div>
                </div>
            </div>

            <div id="successSection" style="display: none;">
                <div class="window">
                    <div class="window-title">QUESTION SUBMITTED</div>
                    <div class="window-content">
                        <div class="success-message">
                            <h2>Thanks for your question!</h2>
                            <p>I'll do my best to get back to you. If it's a longer answer, I might give you a call.</p>
                            <button class="btn" onclick="resetForm()">Ask Another</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-text">
            <p>&copy; 2026 FRACTAL ACCELERATOR. NYC.</p>
            <p>Questions? <a href="mailto:hello@fractaltech.nyc">hello@fractaltech.nyc</a></p>
        </div>
    </footer>

    <script>
        const form = document.getElementById('amaForm');
        const formSection = document.getElementById('formSection');
        const successSection = document.getElementById('successSection');
        const alertError = document.getElementById('alertError');

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            alertError.style.display = 'none';

            let isValid = true;
            const formGroups = form.querySelectorAll('.form-group');
            formGroups.forEach(group => group.classList.remove('error'));

            const name = document.getElementById('name');
            const email = document.getElementById('email');
            const twitter = document.getElementById('twitter');
            const phone = document.getElementById('phone');
            const context = document.getElementById('context');
            const question = document.getElementById('question');
            const tagPreference = document.querySelector('input[name="tagPreference"]:checked');

            if (!name.value.trim()) {
                name.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!email.value.trim() || !email.validity.valid) {
                email.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!twitter.value.trim()) {
                twitter.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!phone.value.trim()) {
                phone.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!context.value.trim()) {
                context.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!question.value.trim()) {
                question.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!tagPreference) {
                document.getElementById('tagGroup').classList.add('error');
                isValid = false;
            }

            if (!isValid) return;

            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            fetch('/api/submit-ama', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: name.value.trim(),
                    email: email.value.trim(),
                    twitter: twitter.value.trim(),
                    phone: phone.value.trim(),
                    context: context.value.trim(),
                    question: question.value.trim(),
                    tag_preference: tagPreference.value
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    formSection.style.display = 'none';
                    successSection.style.display = 'block';
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    throw new Error(data.error || 'Submission failed');
                }
            })
            .catch(error => {
                alertError.textContent = error.message || 'Something went wrong. Please try again.';
                alertError.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            });
        });

        function resetForm() {
            form.reset();
            form.querySelectorAll('.form-group').forEach(g => g.classList.remove('error'));
            alertError.style.display = 'none';
            successSection.style.display = 'none';
            formSection.style.display = 'block';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Real-time validation
        document.querySelectorAll('#amaForm input[required], #amaForm textarea[required]').forEach(input => {
            input.addEventListener('blur', function() {
                if (!this.value.trim() || !this.validity.valid) {
                    this.closest('.form-group').classList.add('error');
                } else {
                    this.closest('.form-group').classList.remove('error');
                }
            });
            input.addEventListener('input', function() {
                if (this.value.trim() && this.validity.valid) {
                    this.closest('.form-group').classList.remove('error');
                }
            });
        });

        document.querySelectorAll('input[name="tagPreference"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.getElementById('tagGroup').classList.remove('error');
            });
        });
    </script>
</body>
</html>
